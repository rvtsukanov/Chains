# Chains
Моделирование и решение задачи пополнения в цепях поставок. 

## Среда
Среда полностью реализована в файле ```env.py``` , каждый шаг на дискретной сетке которой состоит из следующих элементов:
- Спрос случайным образом генерируется из распределения ```demand_generation_function``` и сразу же реализуется из текущего
инвентарного запаса (```Inventory Level```)
- Задача агента - выбрать действие - количество товара для заказа у дистрибьютора. В текцщем примере пространтсво действий - дискретное - целочисленный массив, 
определяемый в ```action_range```. Нет ограничений считать пространство действий непрерывным. 
- Заказ на каждом шаге передается дистрибьютору, который выполняет его с некоторой задержкой, иными словами, пополнение проиходит
через ```fix_delay + N(delay_mean, delay_std)```
- Задача агента - минимизировать издержки на хранение лишних единиц продукции и издержки на непокрытый спрос. Вознаграждение - взвешенные еднициы товара (недопроданного и излишек). 

## Модели
Для решения задачи были реализованы две классические модели: [DQN](https://www.cs.toronto.edu/~vmnih/docs/dqn.pdf)
и [Actor-Critic](https://papers.nips.cc/paper/1786-actor-critic-algorithms.pdf). 

Вознаграждение давалось агенту по следующим схемам: 
- 1 при достижении уровня издержек ```<20``` и ```>-20```; 0 - иначе
- 1 при достижении уровня издержек ```<10``` и ```>-10```; 0 - иначе
- Квадрат уровня издержек

Обе модели были протестированы в сравнении с бейзлайнами: 
- Агент выбирал случайное действие из возможных
- Агент выибирал моду из распредления в пространстве действий

Результаты сравнения предствалены [здесь](https://github.com/rvtsukanov/Chains/blob/master/plots.ipynb):
